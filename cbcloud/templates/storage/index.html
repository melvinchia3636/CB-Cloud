{% extends 'base/base.html' %}
{% load operations %}

{% block breadcrumb %}{% endblock %}

{% block content %}
<div class="flex items-center justify-between mt-12 text-indigo-400 font-bold text-3xl">
	<div class="flex items-center">
		<span class="iconify w-10 h-10 mr-4" data-icon="uil:hdd"></span>
		File Storage
	</div>
	<div class="flex gap-8">
		<button><span class="iconify w-8 h-8 text-gray-700" data-icon="tabler:layout-grid"></span></button>
		<button><span class="iconify w-8 h-8 text-gray-700" data-icon="uil:info-circle"></span></button>
	</div>
</div>
<table class="w-full mt-6" align="left">
	<tr class="text-left text-gray-500 border-b-2 border-gray-200">
		<th class="w-4/12 py-3">Name</th>
		<th class="w-2/12">Last Modified</th>
		<th class="w-2/12">Date Created</th>
		<th class="w-1/12">Size</th>
		<th class="w-2/12">Tags</th>
	</tr>
	{% for file in files %}
	<tr class="border-b-2 border-gray-200 font-medium text-lg file-row relative" {% ifequal file.type "folder" %}onclick="goto('{{file.name}}')"{% endifequal %}>
		<td class="py-3 font-semibold text-xl flex items-center pl-2 pr-4 whitespace-nowrap">
			<span class="iconify w-8 h-8 mr-4 text-indigo-400" data-icon="bx:bxs-{{file.type}}"></span>
			<span class="overflow-ellipsis overflow-hidden" style="max-width: 20rem">{{file.name}}</span>
		</td>
		<td>{{file.last_mod}}</td>
		<td>{{file.created}}</td>
		<td>{% ifequal file.type "file" %}{%fetchshort file.size %}{% else %}-{% endifequal %}</td>
		<td></td>
	</tr>
	{% endfor %}
</table>
<button class="rounded-full w-16 h-16 shadow-md flex items-center justify-center bg-indigo-400 fixed right-6 bottom-6">
	<span class="iconify w-7 h-7 text-white" data-icon="uil:plus" style="stroke: white; stroke-width: .6px"></span>
</button>
{% endblock %}

{% block script %}
const goto = path => window.location += (!(window.location.href[window.location.href.length-1] === "/") ? "/" : "") + path

const arrow = `<svg class="mt-0.5" width="10" height="10" viewBox="0 0 9 9" fill="none" xmlns="http://www.w3.org/2000/svg">
	<path d="M3.375 7.5L6.375 4.5L3.375 1.5" stroke="#5E78FF" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
</svg>`
paths = window.location.pathname.split('/').filter(e => e).map(e => decodeURI(e))
$('#breadcrumb').append(paths.slice(0, paths.length-1).join(arrow))
$('#breadcrumb').append(`${paths.length > 1 ? arrow : ""}<span class='font-bold'>${paths[paths.length-1]}</span>`)

{% endblock %}